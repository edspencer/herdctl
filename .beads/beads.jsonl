{"id":"herdctl-001","title":"Config Parsing Foundation","description":"Implement the configuration parsing foundation for herdctl in packages/core/src/config/. This module parses and validates fleet configuration (herdctl.yaml) and individual agent YAML files, providing a type-safe, validated configuration object for the rest of the system.","status":"tombstone","priority":0,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["feature","ralph"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-002","title":"US-1: Parse Fleet Configuration","description":"As a fleet operator, I want to load a herdctl.yaml file so that I can define my fleet's default settings and agent references.\n\n## Acceptance Criteria\n- [ ] Parses valid herdctl.yaml files using the yaml package\n- [ ] Returns typed FleetConfig object validated by Zod\n- [ ] Throws descriptive errors for invalid YAML syntax\n- [ ] Throws descriptive errors for schema validation failures\n- [ ] Supports all fields from SPEC.md: fleet, defaults, agents, workspace, chat, webhooks, docker\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-003","title":"US-2: Parse Agent Configuration","description":"As a fleet operator, I want to define agents in separate YAML files so that I can organize my agent configurations modularly.\n\n## Acceptance Criteria\n- [ ] Parses agent YAML files referenced by path in fleet config\n- [ ] Returns typed AgentConfig object validated by Zod\n- [ ] Supports all agent fields: name, description, workspace, repo, identity, work_source, schedules, session, permissions, mcp_servers, chat\n- [ ] Handles relative paths resolved from fleet config location\n- [ ] Throws descriptive errors with file path context\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-004","title":"US-3: Merge Defaults with Agent Overrides","description":"As a fleet operator, I want to define fleet-level defaults that agents can override so that I don't repeat common configuration across agents.\n\n## Acceptance Criteria\n- [ ] Fleet defaults section merges into each agent config\n- [ ] Agent-specific values override fleet defaults (deep merge)\n- [ ] Merge applies to: permissions, work_source, session, docker, model, max_turns, permission_mode\n- [ ] Nested objects merge recursively (e.g., permissions.allowed_tools)\n- [ ] Arrays are replaced, not merged (agent's allowed_tools replaces defaults)\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-005","title":"US-4: Environment Variable Interpolation","description":"As a fleet operator, I want to use ${VAR} syntax in YAML values so that I can inject secrets and environment-specific values.\n\n## Acceptance Criteria\n- [ ] Interpolates ${VAR_NAME} patterns in string values\n- [ ] Supports ${VAR:-default} syntax for default values\n- [ ] Throws error for undefined variables without defaults\n- [ ] Preserves non-string values (numbers, booleans, objects)\n- [ ] Works at any nesting depth in the config\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with tests for this functionality","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-006","title":"US-5: Load Complete Configuration","description":"As a developer using @herdctl/core, I want to call a single function to load all config so that I get a fully resolved, validated configuration object.\n\n## Acceptance Criteria\n- [ ] loadConfig(configPath?: string) function auto-discovers herdctl.yaml\n- [ ] Searches current directory and parents (like git does)\n- [ ] Loads fleet config, all referenced agents, merges defaults\n- [ ] Returns ResolvedConfig with all agents fully resolved\n- [ ] Validates entire config tree before returning\n- [ ] Can load examples/simple/herdctl.yaml and resolve all agents\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-19T16:32:24.448999-05:00","updated_at":"2026-01-19T16:34:57.975682-05:00","labels":["ralph","task"],"deleted_at":"2026-01-19T16:34:57.975682-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"herdctl-08c","title":"Config Parsing Foundation","description":"Implement the configuration parsing foundation for herdctl in packages/core/src/config/. This module parses and validates fleet configuration (herdctl.yaml) and individual agent YAML files, providing a type-safe, validated configuration object for the rest of the system.","status":"closed","priority":0,"issue_type":"epic","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:05.79657-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:15:23.987874-05:00","closed_at":"2026-01-19T17:15:23.987874-05:00","close_reason":"Closed","external_ref":"prd:./tasks/config-parsing-prd.md","labels":["feature","ralph"]}
{"id":"herdctl-08c.1","title":"US-1: Parse Fleet Configuration","description":"As a fleet operator, I want to load a herdctl.yaml file so that I can define my fleet's default settings and agent references.\n\n## Acceptance Criteria\n- [ ] Parses valid herdctl.yaml files using the yaml package\n- [ ] Returns typed FleetConfig object validated by Zod\n- [ ] Throws descriptive errors for invalid YAML syntax\n- [ ] Throws descriptive errors for schema validation failures\n- [ ] Supports all fields from SPEC.md: fleet, defaults, agents, workspace, chat, webhooks, docker\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":1,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:24.07093-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:45:38.811398-05:00","closed_at":"2026-01-19T16:45:38.811398-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.1","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:24.071451-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.2","title":"US-2: Parse Agent Configuration","description":"As a fleet operator, I want to define agents in separate YAML files so that I can organize my agent configurations modularly.\n\n## Acceptance Criteria\n- [ ] Parses agent YAML files referenced by path in fleet config\n- [ ] Returns typed AgentConfig object validated by Zod\n- [ ] Supports all agent fields: name, description, workspace, repo, identity, work_source, schedules, session, permissions, mcp_servers, chat\n- [ ] Handles relative paths resolved from fleet config location\n- [ ] Throws descriptive errors with file path context\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:32.594497-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:49:48.666339-05:00","closed_at":"2026-01-19T16:49:48.666339-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.2","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:32.594991-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.2","depends_on_id":"herdctl-08c.1","type":"blocks","created_at":"2026-01-19T16:36:07.490289-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.3","title":"US-3: Merge Defaults with Agent Overrides","description":"As a fleet operator, I want to define fleet-level defaults that agents can override so that I don't repeat common configuration across agents.\n\n## Acceptance Criteria\n- [ ] Fleet defaults section merges into each agent config\n- [ ] Agent-specific values override fleet defaults (deep merge)\n- [ ] Merge applies to: permissions, work_source, session, docker, model, max_turns, permission_mode\n- [ ] Nested objects merge recursively (e.g., permissions.allowed_tools)\n- [ ] Arrays are replaced, not merged (agent's allowed_tools replaces defaults)\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:40.858149-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:55:12.359393-05:00","closed_at":"2026-01-19T16:55:12.359393-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.3","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:40.858665-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.3","depends_on_id":"herdctl-08c.1","type":"blocks","created_at":"2026-01-19T16:36:09.87234-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.3","depends_on_id":"herdctl-08c.2","type":"blocks","created_at":"2026-01-19T16:36:09.932272-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.4","title":"US-4: Environment Variable Interpolation","description":"As a fleet operator, I want to use ${VAR} syntax in YAML values so that I can inject secrets and environment-specific values.\n\n## Acceptance Criteria\n- [ ] Interpolates ${VAR_NAME} patterns in string values\n- [ ] Supports ${VAR:-default} syntax for default values\n- [ ] Throws error for undefined variables without defaults\n- [ ] Preserves non-string values (numbers, booleans, objects)\n- [ ] Works at any nesting depth in the config\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":2,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:47.087373-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T16:58:00.83921-05:00","closed_at":"2026-01-19T16:58:00.83921-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.4","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:47.08787-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.4","depends_on_id":"herdctl-08c.1","type":"blocks","created_at":"2026-01-19T16:36:11.301987-05:00","created_by":"Ed Spencer"}]}
{"id":"herdctl-08c.5","title":"US-5: Load Complete Configuration","description":"As a developer using @herdctl/core, I want to call a single function to load all config so that I get a fully resolved, validated configuration object.\n\n## Acceptance Criteria\n- [ ] loadConfig(configPath?: string) function auto-discovers herdctl.yaml\n- [ ] Searches current directory and parents (like git does)\n- [ ] Loads fleet config, all referenced agents, merges defaults\n- [ ] Returns ResolvedConfig with all agents fully resolved\n- [ ] Validates entire config tree before returning\n- [ ] pnpm typecheck passes in packages/core\n- [ ] pnpm test passes with \u003e90% coverage of config module","status":"closed","priority":3,"issue_type":"task","owner":"ed@edspencer.net","created_at":"2026-01-19T16:35:53.473938-05:00","created_by":"Ed Spencer","updated_at":"2026-01-19T17:03:13.886438-05:00","closed_at":"2026-01-19T17:03:13.886438-05:00","close_reason":"Completed by agent","labels":["ralph","task"],"dependencies":[{"issue_id":"herdctl-08c.5","depends_on_id":"herdctl-08c","type":"parent-child","created_at":"2026-01-19T16:35:53.4744-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.5","depends_on_id":"herdctl-08c.3","type":"blocks","created_at":"2026-01-19T16:36:12.905191-05:00","created_by":"Ed Spencer"},{"issue_id":"herdctl-08c.5","depends_on_id":"herdctl-08c.4","type":"blocks","created_at":"2026-01-19T16:36:12.965556-05:00","created_by":"Ed Spencer"}]}
