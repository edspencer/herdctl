Running security checks...

  Checking npm-audit... WARN (2ms, 1 findings)
  Checking docker-config... FAIL (131ms, 3 findings)
  Checking permission-modes... FAIL (25ms, 2 findings)
  Checking subprocess-patterns... WARN (29ms, 4 findings)
  Checking path-safety... PASS (3ms, 0 findings)
  Checking env-handling... PASS (86ms, 0 findings)
════════════════════════════════════════════════════════════
  HERDCTL SECURITY SCAN REPORT
════════════════════════════════════════════════════════════

  Date:    2026-02-13
  Commit:  6fb7760
  Branch:  feature/simplify-security-fleet-yaml
  Status:  FAIL

────────────────────────────────────────────────────────────
  SUMMARY
────────────────────────────────────────────────────────────
  Total checks: 6  |  Passed: 2  |  Warned: 2  |  Failed: 2

────────────────────────────────────────────────────────────
  NPM-AUDIT (warn)
────────────────────────────────────────────────────────────
  [.] [LOW] Could not parse pnpm audit output - manual review recommended
      Recommendation: Run `pnpm audit` manually to check for vulnerabilities

────────────────────────────────────────────────────────────
  DOCKER-CONFIG (fail)
────────────────────────────────────────────────────────────
  [!] [HIGH] hostConfigOverride can bypass Docker security hardening
      Location: packages/core/src/runner/runtime/docker-config.ts:260
      Recommendation: Ensure this is only used at fleet-level config, never from agent input

  [!] [HIGH] hostConfigOverride can bypass Docker security hardening
      Location: packages/core/src/runner/runtime/container-manager.ts:142
      Recommendation: Ensure this is only used at fleet-level config, never from agent input

  [!] [HIGH] hostConfigOverride can bypass Docker security hardening
      Location: packages/core/src/runner/runtime/container-manager.ts:143
      Recommendation: Ensure this is only used at fleet-level config, never from agent input

────────────────────────────────────────────────────────────
  PERMISSION-MODES (fail)
────────────────────────────────────────────────────────────
  [!] [HIGH] bypassPermissions used in 69 production config file(s)
      Location: .herdctl/jobs/job-2026-02-12-adqqc2.yaml:40, .herdctl/jobs/job-2026-02-12-adqqc2.yaml:93, .herdctl/jobs/job-2026-02-12-aj4aj0.yaml:51, .herdctl/jobs/job-2026-02-13-q3hcq4.yaml:56, .herdctl/jobs/job-2026-02-13-q3hcq4.yaml:141, .herdctl/jobs/job-2026-02-13-xj5mbf.yaml:59, .herdctl/jobs/job-2026-02-13-xj5mbf.yaml:64, .herdctl/jobs/job-2026-02-13-xj5mbf.yaml:78, .herdctl/jobs/job-2026-02-13-xj5mbf.yaml:120, .herdctl/jobs/job-2026-02-12-sjkgqo.yaml:83, .herdctl/jobs/job-2026-02-12-9oz7be.yaml:65, .herdctl/jobs/job-2026-02-13-i4cm25.yaml:35, .herdctl/jobs/job-2026-02-13-i4cm25.yaml:49, .herdctl/jobs/job-2026-02-13-i4cm25.yaml:74, .herdctl/jobs/job-2026-02-13-190z1d.yaml:37, .herdctl/jobs/job-2026-02-13-190z1d.yaml:46, .herdctl/jobs/job-2026-02-12-uddt5o.yaml:24, .herdctl/jobs/job-2026-02-12-uddt5o.yaml:50, .herdctl/jobs/job-2026-02-12-uddt5o.yaml:52, .herdctl/jobs/job-2026-02-12-uddt5o.yaml:66, .herdctl/jobs/job-2026-02-12-pw00v4.yaml:66, .herdctl/jobs/job-2026-02-12-s82sx6.yaml:54, .herdctl/jobs/job-2026-02-12-s82sx6.yaml:67, .herdctl/jobs/job-2026-02-12-s82sx6.yaml:90, .herdctl/jobs/job-2026-02-12-7ncaad.yaml:71, .herdctl/jobs/job-2026-02-12-zjmv6o.yaml:36, .herdctl/jobs/job-2026-02-12-zjmv6o.yaml:39, .herdctl/jobs/job-2026-02-12-eq2f8e.yaml:108, .herdctl/jobs/job-2026-02-12-55049m.yaml:52, .herdctl/jobs/job-2026-02-12-55049m.yaml:113, .herdctl/jobs/job-2026-02-12-55049m.yaml:143, .herdctl/jobs/job-2026-02-13-31vug3.yaml:30, .herdctl/jobs/job-2026-02-13-31vug3.yaml:31, .herdctl/jobs/job-2026-02-13-31vug3.yaml:44, .herdctl/jobs/job-2026-02-13-31vug3.yaml:61, .herdctl/jobs/job-2026-02-13-31vug3.yaml:73, .herdctl/jobs/job-2026-02-13-31vug3.yaml:78, .herdctl/jobs/job-2026-02-13-31vug3.yaml:86, .herdctl/jobs/job-2026-02-13-y79kfq.yaml:62, .herdctl/jobs/job-2026-02-13-y79kfq.yaml:92, .herdctl/jobs/job-2026-02-13-y79kfq.yaml:97, .herdctl/jobs/job-2026-02-13-y79kfq.yaml:153, .herdctl/jobs/job-2026-02-12-r4gi8w.yaml:70, .herdctl/jobs/job-2026-02-13-89om5k.yaml:43, .herdctl/jobs/job-2026-02-13-89om5k.yaml:45, .herdctl/jobs/job-2026-02-13-89om5k.yaml:66, .herdctl/jobs/job-2026-02-12-hak8zr.yaml:46, .herdctl/jobs/job-2026-02-12-p17eg9.yaml:74, .herdctl/jobs/job-2026-02-12-p17eg9.yaml:87, .herdctl/jobs/job-2026-02-12-bx63b1.yaml:39, .herdctl/jobs/job-2026-02-12-bx63b1.yaml:70, .herdctl/jobs/job-2026-02-13-d254xd.yaml:63, .herdctl/jobs/job-2026-02-12-c8zfz8.yaml:32, .herdctl/jobs/job-2026-02-12-c8zfz8.yaml:78, .herdctl/jobs/job-2026-02-12-1vb8ws.yaml:65, .herdctl/jobs/job-2026-02-12-1vb8ws.yaml:102, .herdctl/jobs/job-2026-02-12-s20pip.yaml:110, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:63, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:87, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:116, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:140, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:160, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:175, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:220, .herdctl/jobs/job-2026-02-12-5ox38f.yaml:242, .herdctl/jobs/job-2026-02-12-6ift81.yaml:78, .herdctl/jobs/job-2026-02-12-6ift81.yaml:90, .herdctl/jobs/job-2026-02-13-xcsi51.yaml:46, .herdctl/jobs/job-2026-02-13-xcsi51.yaml:86
      Recommendation: bypassPermissions bypasses ALL safety checks. Review each usage carefully.

  [.] [LOW] bypassPermissions used in 1 example config(s) - consider adding Docker isolation
      Location: examples/bragdoc-developer/agents/developer.yaml:47
      Recommendation: Example configs with bypassPermissions should demonstrate Docker isolation for security.

────────────────────────────────────────────────────────────
  SUBPROCESS-PATTERNS (warn)
────────────────────────────────────────────────────────────
  [.] [LOW] Direct child_process import - consider using execa instead
      Location: packages/core/src/hooks/runners/shell.ts:8
      Recommendation: execa provides better escaping and cross-platform support

  [.] [LOW] Direct child_process import - consider using execa instead
      Location: packages/cli/src/commands/sessions.ts:14
      Recommendation: execa provides better escaping and cross-platform support

  [~] [MEDIUM] shell: true option enables shell interpretation
      Location: packages/core/src/hooks/runners/shell.ts:154
      Recommendation: Avoid shell: true unless necessary - it enables shell metacharacter processing

  [~] [MEDIUM] shell: true option enables shell interpretation
      Location: packages/cli/src/commands/sessions.ts:415
      Recommendation: Avoid shell: true unless necessary - it enables shell metacharacter processing

════════════════════════════════════════════════════════════
  Completed in 286ms
════════════════════════════════════════════════════════════
